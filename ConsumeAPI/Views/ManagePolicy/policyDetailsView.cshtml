@model ConsumeAPI.Models.PolicyDetailsModel


@{
    ViewData["Title"] = "policyDetailsView";
}


@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers


<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon/favicon.png">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://kendo.cdn.telerik.com/2022.1.301/styles/kendo.common.min.css">
    <link rel="stylesheet" href="https://kendo.cdn.telerik.com/2022.1.301/styles/kendo.default.min.css">
    <title>Funeralbiz</title>


    <style>


        .k-datepicker .k-input {
            height: 40px;
            line-height: 20px;
        }

        .k-dropdown-wrap .k-input {
            height: 40px;
            line-height: 40px;
        }

        .k-grid table thead th {
            background-color: var(--secondary-color);
            text-transform: uppercase;
            white-space: nowrap;
            font-weight: 400;
        }

        .k-grid table {
            border-collapse: collapse !important;
        }

            .k-grid table tbody td {
                color: black;
            }

        .k-alt {
            background-color: rgba(0, 0, 0, 0.05) !important;
        }

        .k-header {
            background-image: none !important;
            background-color: #4472c4; /* Combined background color */
        }

        .k-grid-header .k-header > .k-link {
            color: white !important;
        }

        .k-grid td, .k-grid-header, .k-widget {
            border-color: #dee2e6 !important;
        }

        .k-grid tr:hover {
            background-color: #f0f0f0 !important; /* Change to your desired hover color */
        }

        .k-window {
            border-radius: 50px;
            overflow: hidden;
        }

        .custom-button{
            background-color: #ef7f1b;
            color:white;
          
        }


        .k-list-scroller {
           
            overflow-y: scroll !important;
        }
           
 

    </style>
   
</head>

<body>


    <div class="dashaboard-main">
        <div class="container">
            <div class="dashaboard-content">
                <div class="dashaboard-inner">
                    <div class="page-header">
                        <div class="d-lg-flex">
                            <div class="flex-grow-1">
                                <h2 class="heading01 mb-3 mb-lg-0 text-lg-start text-center">Manage Policy</h2>
                            </div>
                        </div>
                    </div>

                    <div class="content-wrapper">
                        <div class="d-lg-flex">
                            <div class="app-sidebar" tabindex="-1" id="offcanvassidebar">
                                <div class="offcanvas-header d-flex align-items-center justify-content-end d-none">
                                    <span class="text-white" data-bs-dismiss="offcanvas" aria-label="Close">
                                        <i class="bi bi-x-lg"></i>
                                    </span>
                                </div>
                                <div class="sidebar-inner">
                                    <div class="sidebar-list-item">
                                        <ul class="list-unstyled nav nav-tabs">
                                            <li class="nav-item">
                                                <a class="nav-link active" data-bs-toggle="tab" href="#Tab-1">
                                                    Policy
                                                    Details
                                                </a>
                                            </li>
                                            <li class="nav-item">
                                                <a class="nav-link" data-bs-toggle="tab" href="#Tab-2">
                                                    Policy Status
                                                    History
                                                </a>
                                            </li>
                                            <li class="nav-item">
                                                <a class="nav-link" data-bs-toggle="tab" href="#Tab-3">
                                                    Valued-Added
                                                    Services
                                                </a>
                                            </li>
                                            <li class="nav-item">
                                                <a class="nav-link" data-bs-toggle="tab" href="#Tab-4">
                                                    Policy Invoice &
                                                    Payment
                                                </a>
                                            </li>
                                            <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#Tab-5">Policy Claims</a></li>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                            <div class="content-area tab-content">
                                <div class="tab-pane active fade show" id="Tab-1">
                                    <div class="table-caption-top text-white mb-3">
                                        <h3 class="heading02 text-center">Policies Details</h3>
                                    </div>

                                    <form asp-controller="ManagePolicy" asp-action="policyDetailsView" method="post" id="policyForm">
                                        <div class="card card-globel p-4 border-0 mb-4">
                                            <div class="row">
                                                <div class="col-xl-3 col-md-6 my-2">
                                                    <div class="form-group">

                                                        <label asp-for="IntPolicyNum" class="form-label">Policy Number:<strong style="color:red">*</strong></label>
                                                        <input asp-for="IntPolicyNum" class="form-control">
                                                        <span asp-validation-for="IntPolicyNum" class="text-danger"></span>
                                                    </div>
                                                </div>
                                                <div class="col-xl-3 col-md-6 my-2">
                                                    <div class="form-group">
                                                        <label asp-for="StrPlanBrandName" class="form-label">Plan Brand Name:<strong style="color:red">*</strong></label>
                                                       
                                                        <option id="Planbrandname" style="width: 100%;"></option>
                                                        <span asp-validation-for="StrPlanBrandName" class="text-danger"></span>
                                                    </div>

                                                    <script>
                                                        let encode2 = kendo.htmlEncode;
                                                        $("#Planbrandname").kendoDropDownList({
                                                            rounded: "large",
                                                            optionLabel: 'Select Plan Brand',
                                                            dataTextField: "strPlanBrandName",
                                                            dataValueField: "strPlanBrandName",
                                                            footerTemplate: ({ instance }) => `Total <strong>${encode2(instance.dataSource.total())}</strong> items found`,
                                                            dataSource: {
                                                                transport: {
                                                                    read: {
                                                                        url: "/ManagePolicy/GetPlanBrandList",
                                                                        dataType: "json",
                                                                        type: "GET"
                                                                    }
                                                                }
                                                            }
                                                        });

                                                    </script>
                                                </div>
                                                <div class="col-xl-3 col-md-7 my-2">
                                                    <div class="form-group">
                                                        <label for="agentDropdown" class="form-label">Agent</label>
                                                        <option id="agentDropdown" style="width: 100%;"></option>
                                                    </div>

                                                    <script>
                                                        let encode = kendo.htmlEncode;
                                                        $("#agentDropdown").kendoDropDownList({
                                                            rounded: "large",
                                                            optionLabel: 'Select Agent',
                                                            dataTextField: "strAgentNameID",
                                                            dataValueField: "strAgentNameID",
                                                            footerTemplate: ({ instance }) => `Total <strong>${encode(instance.dataSource.total())}</strong> items found`,
                                                            dataSource: {
                                                                transport: {
                                                                    read: {
                                                                        url: "/ManagePolicy/GetPolicyAgentList",
                                                                        dataType: "json",
                                                                        type: "GET"
                                                                    }
                                                                }
                                                            }
                                                        });

                                                    </script>

                                                </div>
                                                <div class="col-xl-3 col-md-6 my-2">
                                                    <div class="form-group">
                                                        <label class="form-label">%Comm Rate:</label>
                                                        <input type="email" class="form-control" placeholder="">
                                                    </div>
                                                </div>
                                                <div class="col-xl-3 col-md-5 my-2">
                                                    <div class="form-group position-relative">
                                                        <label for="datepicker1" class="form-label">Date Opened:<strong style="color:red">*</strong></label>
                                                        <input class="form-control" id="datepicker1" style="width: 100%;" />

                                                    </div>
                                                </div>
                                                <script>
                                                    $(document).ready(function () {
                                                        $("#datepicker1").kendoDatePicker({
                                                            animation: false,
                                                            size: "large",
                                                            innerWidth: "20px",
                                                            format: "yyyy-MM-dd",
                                                            value: new Date(),
                                                            height: 20

                                                        });
                                                    });
                                                </script>

                                                <div class="col-xl-3 col-md-5 my-2">
                                                    <div class="form-group position-relative">
                                                        <label asp-for="DatInceptionDate" for="datepicker2" class="form-label">Inception Date:<strong style="color:red">*</strong></label>
                                                        <input asp-for="DatInceptionDate" class="form-control" id="datepicker2" style="width: 100%;" />
                                                        <span asp-validation-for="DatInceptionDate" class="text-danger"></span>
                                                    </div>
                                                </div>
                                                <script>
                                                    $(document).ready(function () {
                                                        $("#datepicker2").kendoDatePicker({
                                                            animation: false,
                                                            size: "large",
                                                            format: "yyyy-MM-dd" // Example format, adjust as needed

                                                        });
                                                    });
                                                </script>


                                                <div class="col-xl-3 col-md-5 my-2">
                                                    <div class="form-group position-relative">
                                                        <label asp-for="DatDateClosed" for="datepicker3" class="form-label">Date Closed:<strong style="color:red">*</strong></label>
                                                        <input asp-for="DatDateClosed" class="form-control" id="datepicker3" style="width: 100%;" />
                                                        <span asp-validation-for="DatDateClosed" class="text-danger"></span>
                                                    </div>
                                                </div>
                                                <script>
                                                    $(document).ready(function () {

                                                        $("#datepicker3").kendoDatePicker({
                                                            animation: false,
                                                            size: "large",
                                                            format: "yyyy-MM-dd"// Example format, adjust as needed

                                                        });
                                                    });
                                                </script>
                                            </div>
                                        </div>
                                    </form>


                                    <div class="page-header">
                                        <div class="d-lg-flex">
                                            <div class="flex-grow-1">
                                                <h2 class=" font-weight-bold mb-3 mb-lg-0 text-lg-start text-center">Policies Member</h2>
                                            </div>
                                            <div class="col-auto">
                                                <div class="d-flex flex-column flex-lg-row align-items-center justify-content-center justify-content-lg-end">
                                                    <div class="dropdown filter-area mb-3 mb-lg-0">
                                                        <button class="btn shadow-none" type="button" id="dropdownMenu2" data-bs-toggle="dropdown"
                                                                aria-expanded="false">
                                                            <i class="bi bi-funnel-fill"></i> Filter
                                                        </button>
                                                        <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdownMenu2">
                                                            <li><a href="" class="dropdown-item">Action</a></li>
                                                            <li><a href="" class="dropdown-item">Another action</a></li>
                                                            <li><a href="" class="dropdown-item">Something else here</a></li>
                                                        </ul>
                                                    </div>

                                                    <div class="d-flex flex-column flex-lg-row align-items-stretch top-search-area ms-lg-4">
                                                        <input id="searchInput" type="text" class="form-control" placeholder="Search Policy">
                                                    </div>




                                                </div>
                                            </div>
                                        </div>
                                    </div>


                                    <div id="policydetails" style="margin-top:20px;"></div>

                                    <script>
                                        $(function () {
                                            var gridDataSource = new kendo.data.DataSource({
                                                transport: {
                                                    read: {
                                                        url: "/ManagePolicy/Getpolicymembers",
                                                        datatype: "json",
                                                        type: "GET"
                                                    },
                                                    create: {
                                                        url: "/ManagePolicy/CreatePolicyMember",
                                                        dataType: "json", 
                                                        type: "POST" ,
                                                        contentType: "application/json"
                                                    }
                                                },
                                                pageSize: 7,
                                                schema: {
                                                    model: {
                                                        id: "intProfileID",
                                                        fields: {
                                                            intMemberTypeID: { type: "number" },
                                                            strMemberType: { type: "string" },
                                                            strIDPPNum: { type: "string" },
                                                            strMemberName: { type: "string", editable: false, nullable: true },
                                                            datBirthDate: { type: "date", editable: false, nullable: true },
                                                            intAgeToday: { type: "number", editable: false, nullable: true },
                                                            monPremiumAmt: { type: "number", editable: false, nullable: true },
                                                            monCoverAmt: { type: "number" },
                                                            datDateEnrolled: { type: "date" },
                                                            coverStatus: { type: "string", editable: false, nullable: true },
                                                            strRelationshipToMainMember: { type: "string" },
                                                            strBeneficiaryNameID: { type: "string" },
                                                            strBenRelationshipToPolMember: { type: "string" },
                                                            bitConsentRecvdYN: { type: "boolean" },
                                                            intRelationshipId: { type: "number" },
                                                            strRelationship: { type: "string" },
                                                            intProfileID: { type: "number" },
                                                            strName: { type: "string" },
                                                            strIDPPNum: { type: "number" }

                                                                                                    
                                                        }
                                                    }
                                                }
                                            });

                                           var grid =  $("#policydetails").kendoGrid({
                                                dataSource: gridDataSource,
                                                height: 300,
                                                sortable: true,
                                                filterable: true,
                                                editable: "inline",
                                                scrollable: true,
                                                columns: [
                                                    {
                                                        command: [
                                                            {
                                                                name: "edit",
                                                                template: "<a class='icon-pencil k-button-icontext k-grid-edit fa-lg' ><i class='fa fa-pencil-square-o '></i></a>",                                    
                                                                iconClass: { update: "fa fa-save fa-xl", cancel: "fa fa-close fa-lg" },
                                                            },
                                                            {
                                                                name: "destroy",
                                                                template: "<a class='icon-delete k-button-icontext k-grid-delete fa-lg'><i class='fa fa-trash'></i></a>"
                                                            }
                                                        ],
                                                       
                                                        title: "&nbsp;",
                                                        width: "150px"
                                                    },
                                                    {
                                                        field: "strMemberType",
                                                        title: "Member Type",
                                                        type: "string",
                                                        width: "250px",
                                                        template: "#= strMemberType #",
                                                        editor: function(container, options) {
                                                            let encode = kendo.htmlEncode;
                                                            $('<input data-bind="value:' + options.field + '"/>')
                                                                .appendTo(container)
                                                                .kendoDropDownList({
                                                                    rounded: "large",
                                                                    optionLabel: 'Select Member Type',
                                                                    dataTextField: "strMemberType",
                                                                    dataValueField: "intMemberTypeID",
                                                                    footerTemplate: ({ instance }) => `Total <strong>${encode(instance.dataSource.total())}</strong> items found`,
                                                                    dataSource: {
                                                                        transport: {
                                                                            read: {
                                                                                url: "/ManagePolicy/GetMemberTypeList",
                                                                                dataType: "json"
                                                                            }
                                                                        }
                                                                    }
                                                                });
                                                        }
                                                    },
                                                    {
                                                        field: "bitConsentRecvdYN",
                                                        title: "Consent Received",
                                                        width: "150px",
                                                        template: function (dataItem) {
                                                           
                                                            return '<div class="form-check form-switch">' +
                                                                '<input class="form-check-input" type="checkbox" ' + (dataItem.bitConsentRecvdYN ? 'checked' : '') + ' disabled>' +
                                                                '<label class="form-check-label" for="flexSwitchCheckDefault2"></label>' +
                                                                '</div>';
                                                        },
                                                        editor: function (container, options) {
                                                            
                                                            $('<div class="form-check form-switch">' + '<input class="form-check-input" type="checkbox" name="' + options.field + '" data-type="boolean" />' + '<label class="form-check-label" for="flexSwitchCheckDefault2"></label>' +
                                                                '</div>').appendTo(container);
                                                        }
                                                    },



                                                    { field: "strIDPPNum", title: "IDPP Number", type: "string", width: "300px" 
                                                        // editor: function (container, options) {
                                                           
                                                        //     $('<input data-bind="value:' + options.field + '"/>')
                                                        //         .appendTo(container)
                                                        //         .kendoDropDownList({
                                                        //             rounded: "large",
                                                        //             optionLabel: 'Select Relationship Type',
                                                        //             dataTextField: "strName",
                                                        //             dataValueField: "intProfileID",
                                                        //             template: '<span>#: data.strName # - #: data.strIDPPNum #</span>',
                                                                    
                                                        //             dataSource: {
                                                        //                 transport: {
                                                        //                     read: {
                                                        //                         url: "/ManagePolicy/GetIDPPNumberList",
                                                        //                         dataType: "json"
                                                        //                     }
                                                        //                 },
                                                        //                 pageSize: 10,
                                                        //                 serverPaging: true,
                                                        //                 serverFiltering: true
                                                        //             }


                                                        //         });
                                                        // }
                                                    },
                                                    { field: "strMemberName", title: "Member Name", type: "string", width: "200px", editable: false },
                                                    { field: "datBirthDate", title: "Birth Date", type: "date", format: "{0:dd-MMMM-yyyy}", width: "200px", editable: false },
                                                    { field: "intAgeToday", title: "Age Today", type: "number", width: "200px", editable: false },
                                                    { field: "monPremiumAmt", title: "Premium Amount", type: "number", width: "200px" },
                                                    { field: "monCoverAmt", title: "Cover Amount", type: "number", width: "200px" },
                                                    { field: "datDateEnrolled", title: "Date Enrolled", type: "date", format: "{0:dd-MMMM-yyyy}", width: "200px" },
                                                    { field: "coverStatus", title: "Cover Status", type: "string", width: "200px" },


                                                    {
                                                        field: "strRelationshipToMainMember",
                                                        title: "Relationship Main Member",
                                                        type: "string",
                                                        width: "270px",
                                                        editor: function (container, options) {
                                                            let encode = kendo.htmlEncode;
                                                            $('<input data-bind="value:' + options.field + '"/>')
                                                                .appendTo(container)
                                                                .kendoDropDownList({
                                                                    rounded: "large",
                                                                    optionLabel: 'Select Relationship Type',
                                                                    dataTextField: "strRelationship",
                                                                    dataValueField: "intRelationshipId",
                                                                    footerTemplate: ({ instance }) => `Total <strong>${encode(instance.dataSource.total())}</strong> items found`,
                                                                    dataSource: {
                                                                        transport: {
                                                                            read: {
                                                                                url: "/ManagePolicy/GetRelationshipList",
                                                                                dataType: "json"
                                                                            }
                                                                        }
                                                                       
                                                                    }
                                                                   
                                                                   
                                                                });
                                                        }
                                                    },


                                                    
                                                    { field: "strBeneficiaryNameID", title: "Beneficiary Name ID", type: "string", width: "200px" },


                                                    { field: "strBenRelationshipToPolMember", title: "Beneficiary Relationship", type: "string", width: "280px" ,
                                                        editor: function (container, options) {
                                                            let encode = kendo.htmlEncode;
                                                            $('<input data-bind="value:' + options.field + '"/>')
                                                                .appendTo(container)
                                                                .kendoDropDownList({
                                                                    rounded: "large",
                                                                    optionLabel: 'Select Benf. Relationship Type',
                                                                    dataTextField: "strRelationship",
                                                                    dataValueField: "intRelationshipId",
                                                                    footerTemplate: ({ instance }) => `Total <strong>${encode(instance.dataSource.total())}</strong> items found`,
                                                                    dataSource: {
                                                                        transport: {
                                                                            read: {
                                                                                url: "/ManagePolicy/GetRelationshipList",
                                                                                dataType: "json"
                                                                            }
                                                                        }
                                                                       
                                                                    }
                                                                   
                                                                });
                                                        }
                                                    },
                                                ],
                                                toolbar: [
                                                    {
                                                        name: "create",
                                                        template: "<a class='k-button k-button-icontext k-grid-add' style='background-color: darkorange;'><i class='fa fa-plus'></i>Add New Record</a>"
                                                    }
                                                ],
                                                save: function (e) {
                                                    if (e.model.isNew()) {
                                                        gridDataSource.sync(); 
                                                    }
                                                }
                                            }).data("kendoGrid")


                                            $("#searchInput").on("input", function () {
                                                var value = $(this).val().toLowerCase();
                                                grid.dataSource.filter({
                                                    logic: "or",
                                                    filters: [
                                                        { field: "strMemberName", operator: "contains", value: value }
                                                    ]
                                                });
                                            });
                                        });
                                    </script>





                                   @*  <ul class="pagination justify-content-between">
                                        <li class="page-item ms-auto">
                                            <a href="#" class="btnNext">
                                                <span class="me-2">Next</span>
                                                <svg width="32" height="24" viewBox="0 0 32 24" fill="currentColor"
                                                     xmlns="http://www.w3.org/2000/svg">
                                                    <path d="M31.5061 22.9164V1.0284L31.5065 1.0264L31.5061 1.0244V0.930402H31.4965C31.4733 0.679676 31.3574 0.446613 31.1715 0.276773C30.9856 0.106933 30.7431 0.0125247 30.4913 0.0120026C30.4793 0.0120026 30.4681 0.0152021 30.4565 0.0156021H28.6289C28.6005 0.0132021 28.5729 0.00720215 28.5437 0.00720215C28.2745 0.00730816 28.0165 0.114258 27.8262 0.304547C27.6359 0.494836 27.529 0.752893 27.5289 1.022C27.5289 1.0688 27.5365 1.114 27.5429 1.1592V10.4156L14.2065 2.7156C14.1114 2.6216 13.9909 2.55744 13.8598 2.531C13.7287 2.50457 13.5928 2.51703 13.4687 2.56684C13.3446 2.61664 13.2377 2.70163 13.1613 2.81135C13.0849 2.92107 13.0422 3.05074 13.0385 3.1844H13.0361V9.284L1.65926 2.7152C1.56416 2.6212 1.44366 2.55704 1.31259 2.53061C1.18151 2.50418 1.04556 2.51663 0.921467 2.56644C0.797373 2.61625 0.690541 2.70123 0.614108 2.81095C0.537675 2.92067 0.494975 3.05034 0.491258 3.184H0.489258V20.7964C0.489451 20.933 0.530331 21.0664 0.606682 21.1796C0.683033 21.2929 0.79139 21.3808 0.917927 21.4321C1.04446 21.4835 1.18344 21.496 1.31712 21.4681C1.45079 21.4401 1.57311 21.373 1.66846 21.2752L13.0361 14.712V20.7968C13.0363 20.9334 13.0771 21.0668 13.1535 21.18C13.2298 21.2933 13.3382 21.3812 13.4647 21.4325C13.5913 21.4839 13.7302 21.4964 13.8639 21.4685C13.9976 21.4405 14.1199 21.3734 14.2153 21.2756L27.5429 13.5808V22.9336H27.5481C27.5473 22.9492 27.5433 22.9636 27.5433 22.9792C27.5434 23.2479 27.6501 23.5056 27.8399 23.6958C28.0298 23.886 28.2873 23.9931 28.5561 23.9936H30.4969V23.984C30.6301 23.984 30.7621 23.9578 30.8852 23.9068C31.0083 23.8558 31.1202 23.781 31.2144 23.6868C31.3087 23.5925 31.3834 23.4807 31.4344 23.3575C31.4854 23.2344 31.5117 23.1025 31.5117 22.9692C31.5113 22.9508 31.5069 22.934 31.5061 22.9164Z"
                                                          fill="currentColor" />
                                                </svg>
                                            </a>
                                        </li>
                                    </ul> *@

                                    <div class="container">
                                        <div class="row justify-content-end">
                                            <div class="col-auto">
                                                <button type="button" class="btn btn-primary btnNext" id="submitButton">NEXT</button>
                                            </div>
                                        </div>
                                    </div>

                                    <script>
                                        $(document).ready(function () {
                                            $('#submitButton').click(function (e) {
                                                e.preventDefault(); 

                                                var isValid = $('#policyForm').valid(); 

                                                if (isValid) {
                                                  
                                                    console.log('Form is valid, proceed to the next step');
                                                   
                                                } else {
                                                    
                                                    console.log('Form is invalid');
                                                    
                                                }
                                            });
                                        });
                                    </script>
                                  

                                </div>




                               
                                @Html.Partial("policyHistorypartialview")

                                @Html.Partial("policyValueAddedServicepartialview")

                                @Html.Partial("policyInvoiceandPaymentspartialview")


                                @Html.Partial("policyClaimspartialView")
                               








                               

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>




    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>

    <script src="https://kendo.cdn.telerik.com/2022.1.301/js/kendo.all.min.js"></script>

    @*  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-ajax-unobtrusive/3.2.6/jquery.unobtrusive-ajax.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.3/jquery.validate.min.js"></script>

    @* <script src="https://ajax.aspnetcdn.com/ajax/jquery.validate/1.17.0/jquery.validate.min.js"></script>
    <script src="https://ajax.aspnetcdn.com/ajax/mvc/5.2.3/jquery.validate.unobtrusive.min.js"></script> *@




</body>

</html>

